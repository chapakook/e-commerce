# 🛒 E-Commerce Requirements
## 🎯 배경 (Background)
**좋아요** 누르고, **쿠폰** 쓰고, 포인트로 **결제**하는 **감성 이커머스**.
내가 좋아하는 브랜드의 상품들을 한 번에 담아 주문합니다.
유저 행동은 랭킹과 추천으로 연결됩니다.~~~~

## 📚 요구사항 (Requirements)
- [👤 유저 (Users)](#-유저-users)
- [💰 포인트 (Points)](#-포인트-points)
- [🏷️ 브랜드 (Brands)](#-브랜드-brands)
- [🛍️ 상품 (Products)](#-상품-products)
- [❤️ 좋아요 (Like)](#-좋아요-like)
- [🧾 주문 / 결재 (Orders & Payments)](#-주문--결재-orders--payments)
- [🛒 장바구니 (Cart)](#-장바구니-cart)
- [🎟️ 쿠폰 (Coupons)](#-쿠폰-coupons)

## 👤 유저 (Users)
### 🎯 목표 (Goals)
- `회원가입` / `프로필 조회` 기능을 제공합니다.
- 유저는 **고유한** `ID`와 `이메일`을 기반으로 식별됩니다.

### ❌ 목표가 아닌 것 (Not Goals)
- `인증` / `인가` 기능은 범위에 포함하지 않습니다.
- 소셜 네트워크 기능(`팔로우`, `메시징`)은 포함하지 않습니다.
- 유저 상태(`활성`, `비활성`, `탈퇴`)는 관리하지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [회원가입]
- [ ] 유저는 `ID`, `성별`, `생년월일`, `이메일`을 제공하여 회원가입할 수 있습니다.
- [ ] `ID`와 `이메일`은 전역에서 ***유일***해야 합니다.
- [ ] ***입력값 누락*** 시 가입에 실패합니다.
- [ ] ***이메일 형식이 잘못된 경우*** 가입에 실패합니다.

#### [프로필 조회]
- [ ] 유저는 자신의 프로필을 조회할 수 있습니다.
- [ ] 프로필은 `ID`, `성별`, `생년월일`, `이메일`을 포함합니다.

#### [식별 방식]
- [ ] 모든 요청은 `X-USER-ID` 헤더를 통해 유저를 식별합니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `회원가입` API 응답 시간: `p95 ≤ 500ms`, p99 ≤ 800ms`.
- [ ] `프로필 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 중복 `ID` 또는 이메일 가입 요청 시 이중 등록되지 않아야 합니다.

## 💰 포인트 (Points)
### 🎯 목표 (Goals)
- 포인트 `충전` / `조회` / `내역 조회` 기능을 제공합니다.
- `포인트 사용`은 주문 과정에서 자동으로 처리되며, 별도의 사용 API는 제공되지 않습니다.

### ❌ 목표가 아닌 것 (Not Goals)
- **포인트 환전**(현금 출금) 기능은 이번 범위에 포함하지 않습니다.
- **포인트 만료 정책**(유효기간)은 이번 범위에서 다루지 않습니다.
- **복잡한 적립 규칙**(예: `프로모션`, `이벤트 적립`)은 이번 범위에서 다루지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [포인트 충전]
- [ ] 유저는 자신의 계정을 통해 포인트를 충전할 수 있습니다.
- [ ] 충전 성공 시 잔액이 증가하고, 내역이 기록됩니다.

#### [포인트 조회]
- [ ] 유저는 현재 포인트 잔액을 조회할 수 있습니다.

#### [포인트 사용]
- [ ] 주문 결제 시 자동으로 포인트가 차감됩니다.
- [ ] 잔액 부족 시 주문은 실패합니다.
- [ ] 차감 내역은 포인트 내역에 기록됩니다.

#### [포인트 내역 조회]
- [ ] 유저는 자신의 포인트 내역을 조회할 수 있습니다.
- [ ] 내역 항목에는 `유형(충전/사용)`, `금액`, `잔액`, `관련 주문 ID`, `발생일시`가 포함됩니다.

#### [식별 방식]
- [ ] 모든 요청은 `X-USER-ID` 헤더를 기반으로 유저를 식별합니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `포인트 충전` API 응답 시간: `p95 ≤ 500ms`, `p99 ≤ 800ms`.
- [ ] `포인트 조회` / `내역 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 중복 요청 발생 시 포인트가 ***이중 처리***되지 않아야 합니다.
- [ ] 다중 요청 상황에서도 ***포인트 잔액 정합성이 보장***되어야 합니다.

#### [로깅]
- [ ] 포인트 `충전` / `사용` / `조회`는 로그로 기록됩니다.
- [ ] 로그에는 `유저 ID`, `주문 ID`, `금액`, `발생일시`가 포함됩니다.

## 🏷️ 브랜드 (Brands)
### 🎯 목표 (Goals)
- 브랜드 `등록` / `상세 조회` 기능을 제공합니다.
- 상품 등록 시 브랜드와 연계됩니다.

### ❌ 목표가 아닌 것 (Not Goals)
- 브랜드 `목록 조회` 기능은 범위에 포함하지 않습니다.
- 관리자 `권한` / `인가` 로직 구현은 범위에 포함하지 않습니다.
- 브랜드별 `마케팅` / `배너` / `프로모션` 설정은 포함하지 않습니다.
- `정산`/`수수료`/`쿠폰` 등 비즈니스 정책은 이번 범위에서 다루지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [브랜드 등록]
- [ ] 브랜드는 `브랜드명`을 통해 등록할 수 있습니다.
- [ ] `브랜드명`은 전역에서 유일해야 하며, 2자 이상 50자 이내여야 합니다.

#### [브랜드 상세 조회]
- [ ] `브랜드 ID`을 이용 상세 정보를 조회할 수 있습니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `브랜드 등록` API 응답 시간: `p95 ≤ 500ms`, `p99 ≤ 800ms`.
- [ ] `브랜드 상세 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 동일한 브랜드명이 중복 등록되지 않아야 합니다.

## 🛍️ 상품 (Products)
### 🎯 목표 (Goals)
- 상품 `등록` / `목록 조회` / `상세 조회` 기능을 제공합니다.
- 상품은 특정 브랜드에 속하며, 옵션(색상/사이즈 등) 조합으로 구분됩니다.
- 재고는 상품 옵션 단위에서 관리됩니다.

### ❌ 목표가 아닌 것 (Not Goals)
- 상품 `삭제` / `리뷰` / `평점` 기능은 포함하지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [상품 등록]
- [ ] 상품은 유효한 `브랜드 ID`에만 등록할 수 있습니다.
- [ ] `상품명`은 2자 이상 100자 이내여야 합니다.
- [ ] `가격`은 0 이상의 정수여야 합니다.
- [ ] 옵션(`색상`, `사이즈`) 조합은 상품 내에서 유일해야 합니다.
- [ ] 옵션별 `초기 재고`를 입력해야 합니다.
- [ ] 등록 성공 시 시스템은 `상품 ID`를 발급하여 반환합니다.

#### [상품 목록 조회]
- [ ] `브랜드 ID`를 기준으로 상품을 조회할 수 있습니다.
- [ ] 정렬은 `최신순`, `가격순`, `좋아요순`을 지원합니다.
- [ ] 페이징(`페이지 번호`, `페이지 크기`)을 지원합니다.
- [ ] `include=options` 파라미터를 통해 각 상품의 옵션(`SKU`) 요약 정보를 함께 조회할 수 있습니다.

#### [상품 상세 조회]
- [ ] 유저는 `상품 ID`(`UNI-SKU`)로 상품의 상세 정보를 조회할 수 있습니다.
- [ ] 상세 정보에는 `상품명`, `브랜드 ID`, `설명`,` 대표 이미지 목록`, `대표 가격`, `총 좋아요 수`가 포함됩니다.
- [ ] `include=options` 파라미터를 사용하면 모든 옵션(`SKU`)의 상세 정보(`sku`, `색상`, `사이즈`, `가격`, `재고`)를 포함해야 합니다.
- [ ] 잘못된 `UNI-SKU`가 전달되면 `404 Not Found`를 반환합니다.

#### [제약]
- [ ] 상품은 반드시 옵션을 모두 가져야 합니다.
- [ ] 옵션이 없는 상품은 등록할 수 없습니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `상품 등록` API 응답 시간: `p95 ≤ 500ms`, `p99 ≤ 800ms`.
- [ ] `상품 목록 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.
- [ ] `상품 상세 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 잘못된 `브랜드 ID`로 상품이 등록되지 않아야 합니다.
- [ ] 옵션 조합 중복이 허용되지 않아야 합니다.
- [ ] 재고 차감은 주문 시점에 정확히 처리되어야 합니다.

## ❤️ 좋아요 (Like)
### 🎯 목표 (Goals)
- 상품에 대한 `좋아요 등록` / `좋아요 취소` / `내가 좋아요한 상품 목록 조회` 기능을 제공합니다.
- 상품 `목록` / `상세` 조회 시 총 좋아요 수를 표기합니다.

### ❌ 목표가 아닌 것 (Not Goals)
- 댓글/리뷰/평점 등 소셜 기능
- 알림/피드/랭킹 기능
- 옵션(색상/사이즈) 단위 좋아요(※ 상품 단위로만 관리)

### ✅ 기능적 요구사항 (Functional Requirements)
#### [정책]
- [ ] 사용자는 각 상품당 한 번만 좋아요를 누를 수 있습니다.
- [ ] `좋아요 등록`과 `좋아요 취소`는 멱등성을 보장해야 합니다.
- [ ] 같은 요청을 반복해도 결과/카운트가 변하지 않음

#### [좋아요 등록]
- [ ] 이미 좋아요 상태인 경우에도 정상 처리행야합니다.

#### [좋아요 취소]
- [ ] 이미 취소 상태인 경우에도 정상 처리행야합니다.
- [ ] 실제 취소 시 총 좋아요 수는 음수가 될 수 없습니다.

#### [내가 좋아요한 상품 목록 조회]
- [ ] 본인 기준 목록 조회, 최신 좋아요순 기본 정렬, 페이징 지원

#### [상품 목록/상세 연동]
- [ ] 응답에 총 좋아요 수(`totalLikes`)를 포함합니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] 좋아요 `등록` / `취소` API 응답 시간:  `p95 ≤ 500ms`, `p99 ≤ 800ms`.
- [ ] `내 좋아요 목록 조회` / `상품 목록·상세 좋아요 수 표기` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 동시 요청에서도 이중 증가/감소가 발생하지 않아야 합니다.
- [ ] 총 좋아요 수는 음수가 될 수 없고, 실제 사용자-상품 관계와 정합해야 합니다.
- [ ] 모든 요청은 `X-USER-ID`로 사용자 식별합니다.

#### [로깅]
- [ ] 좋아요 `등록` / `취소` 는 로그로 기록됩니다.
- [ ] 로그에는 `유저 ID`, `상품 ID`, `동작`, `발생시간`가 포함됩니다.

## 🧾 주문 / 결재 (Orders & Payments)
### 🎯 목표 (Goals)
- 주문 `요청` / `상세 조회` / `목록 조회` 기능을 제공합니다.
- 유저는 장바구니 또는 상품 상세에서 상품을 선택해 주문할 수 있습니다.
- 결재 성공 시 주문 확정(`결재 완료`), 외부 시스템으로 주문 정보 전송

### ❌ 목표가 아닌 것 (Not Goals)
- 주문 `취소` / `반품` / `교환` 프로세스는 포함하지 않습니다.
- 배송(`택배사 연동`, `배송 추적`)은 이번 범위에 포함하지 않습니다.
- 실제 PG사 연동은 이번 범위에 포함하지 않습니다.
- `부분/복합 결제`, `환불/정산`은 이번 범위에 포함하지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [주문]
- [ ] `주문 요청`: 장바구니/상품 상세에서 주문 생성 (`상품 ID`, `옵션`, `수량` 필요, 재고 부족 시 실패)
- [ ] `상세 조회`: `주문 ID` 기준, 상품/금액/상태/일시 포함
- [ ] `목록 조회`: 본인 주문 목록, 최신순, 페이징 지원
- [ ] `상태`: `생성됨` → `결재 완료` | 결재 실패 (결재 결과 반영)

#### [결재]
- [ ] 수단: `포인트`, `PG사 모의 연동`
- [ ] 결재 요청: `주문 ID`, `결재 수단 입력` / `금액 일치 필수` / `멱등성 보장`
    - `포인트`: 포인트 부족 시 실패, 성공 시 포인트·재고 차감 후 결재 완료
    - `PG사 모의 연동`: 요청 후 콜백으로 최종 확정
- [ ] `상세 조회`: `결재 ID` 기준, 금액/수단/상태/일시 조회
- [ ] `상태 조회`: `주문 ID` 기준, `요청됨`/ `성공` / `실패`

#### [외부 전송]
- [ ] 주문이 `결재 완료` 되면 주문 정보를 외부 시스템으로 ***비동기 전송***
- [ ] 전송은 멱등성 보장, 실패 시 재시도 가능

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `주문 요청` API 응답 시간: `p95 ≤ 800ms`, `p99 ≤ 1s`.
- [ ] `주문 상세 조회` / `주문 목록 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 결재 실패 시 주문은 자동으로 `결재 실패` 상태로 전환되어야 합니다.
- [ ] 동일 상품에 대해 동시 주문 시 ***재고가 초과 차감***되지 않아야 합니다.
- [ ] 동일 주문은 외부 전송 시 ***중복 전송***되지 않도록 멱등성이 보장되어야 합니다.

#### [로깅]
- [ ] 주문 `요청` / `실패`는 로그로 기록됩니다.
- [ ] 로그에는 `주문 ID`, `결재 ID`, `유저 ID`, `총 금액`, `할인 금액`, `최종 결재 금액`, `주문 상태`, `발생일시`가 포함됩니다.

## 🛒 장바구니 (Cart)
### 🎯 목표 (Goals)
- 장바구니 `추가` / `조회` / `수정` / `삭제` 기능을 제공합니다.
- 유저는 장바구니에 담긴 상품을 기반으로 주문을 생성할 수 있습니다.

### ❌ 목표가 아닌 것 (Not Goals)
- `위시리스트/찜하기`와 같은 별도의 관심상품 기능은 포함하지 않습니다.
- 여러 장바구니(예: `다중 사용자 공유`, `장바구니 저장/불러오기`) 기능은 포함하지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [장바구니 추가]
- [ ] 유저는 상품(`상품 ID`, `옵션`, `수량`)을 장바구니에 담을 수 있습니다.
- [ ] 동일 상품/옵션이 이미 존재하면 `수량`을 증가시킵니다.

#### [장바구니 조회]
- [ ] 유저는 자신의 장바구니를 조회할 수 있습니다.
- [ ] 조회 결과에는 `상품 정보`, `옵션`, `수량`, `단가`, `합계 금액`이 포함됩니다.

#### [장바구니 수정]
- [ ] 유저는 장바구니 내 특정 항목의 `수량`을 변경할 수 있습니다.
- [ ] 수량이 0 이하로 변경되면 해당 항목은 자동 삭제됩니다.

#### [장바구니 삭제]
- [ ] 유저는 장바구니에서 특정 항목을 제거할 수 있습니다.
- [ ] 유저는 장바구니 전체를 비울 수도 있습니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `장바구니 추가/수정/삭제` API 응답 시간: `p95 ≤ 500ms`, `p99 ≤ 800ms`.
- [ ] `장바구니 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.

#### [무결성]
- [ ] 장바구니는 반드시 유저(`X-USER-ID`)에 귀속되어야 합니다.
- [ ] 장바구니 내 동일 상품/옵션 조합은 중복으로 존재할 수 없습니다.

#### [로깅]
- [ ] 장바구니 `추가` / `수정` / `삭제`는 로그로 기록됩니다.
- [ ] 로그에는 `유저 ID`, `상품 ID`, `옵션`, `수량`, `발생일시`가 포함됩니다.

## 🎟️ 쿠폰 (Coupons)
### 🎯 목표 (Goals)
- 쿠폰 `발급` / `조회` 기능을 제공합니다.
- 유저는 보유 쿠폰을 주문 시 적용하여 결제 금액을 할인받을 수 있습니다.

### ❌ 목표가 아닌 것 (Not Goals)
- 쿠폰 양도/거래는 포함하지 않습니다.
- 쿠폰 해제는 포함하지 않습니다.
- 쿠폰 중복 적용(스태킹) 및 자동 최적할인 탐색은 포함하지 않습니다.
- 외부 제휴/정산 로직은 포함하지 않습니다.

### ✅ 기능적 요구사항 (Functional Requirements)
#### [쿠폰 정책]
- [ ] 할인 방식은 정액(`fixed`) 또는 정율(`rate`)만 지원합니다.
- [ ] 적용 범위는 전 상품(`all`)만 지원합니다.
- [ ] 동시에 1개 쿠폰만 적용할 수 있습니다.
- [ ] 할인 계산 규칙: `최종 결재 금액 = 상품합계 − 쿠폰할인`, 정율(`rate`)는 원 단위 절사를 적용합니다.

#### [쿠폰 발급]
- [ ] 동일 쿠폰(템플릿) 기준으로 유저당 1장만 발급합니다.

#### [쿠폰 조회]
- [ ] 유저는 본인 보유 쿠폰과 사용 가능 여부를 조회할 수 있습니다.

#### [쿠폰 적용]
- [ ] 주문 요청 시 `쿠폰 ID` 또는 `쿠폰 코드`를 전달해 적용합니다.
- [ ] `유효기간`, `사용 가능(미사용/잔량)`, `동시 1개 제한`을 만족해야 합니다.

### ☑️ 비기능적 요구사항 (Non-Functional Requirements)
#### [성능]
- [ ] `보유 쿠폰 조회` API 응답 시간: `p95 ≤ 300ms`, `p99 ≤ 500ms`.
- [ ] `쿠폰 적용` API 응답 시간: `p95 ≤ 500ms`, `p99 ≤ 800ms`.

#### [무결성]
- [ ] 동시 요청에서도 이중 사용/이중 발급이 발생하지 않아야 합니다.
- [ ] 쿠폰 사용 확정은 결재 성공 시점에만 반영되어야 합니다.
- [ ] 할인 계산 규칙은 서비스 전역에서 일관되게 적용되어야 합니다.
- [ ] 운영/관리 경로는 관리자 전용으로 제한됩니다.

#### [로깅]
- [ ] 쿠폰 `발급` / `적용` / `사용 확정` / `결재 실패`는 로그로 기록됩니다.
- [ ] 로그에는 `유저 ID`, `쿠폰 ID`, `주문 ID`, `적용 전/후 금액`, `상태`, `발생일시`가 포함됩니다.